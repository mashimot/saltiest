{"ast":null,"code":"import _classCallCheck from \"C:\\\\dev\\\\saltiest\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\classCallCheck.js\";\nimport _createClass from \"C:\\\\dev\\\\saltiest\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\createClass.js\";\nimport { ChangeDetectorRef } from '@angular/core';\nimport { HtmlElementService } from '../shared/services/html-element.service';\nimport { DragulaService } from 'ng2-dragula';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { NgbModal } from '@ng-bootstrap/ng-bootstrap';\nimport { ConfigChoiceFormComponent } from './config-choice-form/config-choice-form.component';\nimport { Location } from '@angular/common';\nimport { CHOICE_TYPE } from '../_core/consts/choice-type.const';\nimport { BehaviorSubject, Observable } from 'rxjs';\nimport { tap, map, filter, switchMap, startWith, distinctUntilChanged, debounceTime, delay } from 'rxjs/operators';\nimport { ContentChoiceItemService } from '../shared/services/content-choice-item.service';\nimport { FormControl } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../shared/services/html-element.service\";\nimport * as i2 from \"ng2-dragula\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@ng-bootstrap/ng-bootstrap\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"../shared/services/content-choice-item.service\";\nimport * as i7 from \"@angular/forms\";\nimport * as i8 from \"ngx-pagination\";\n\nfunction ConfigChoicesComponent_div_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelementStart(1, \"h1\");\n    i0.ɵɵtext(2, \"Loading...\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n}\n\nvar _c0 = function _c0() {\n  return {\n    \"cursor\": \"pointer\"\n  };\n};\n\nfunction ConfigChoicesComponent_div_14_div_1_li_16_Template(rf, ctx) {\n  if (rf & 1) {\n    var _r12 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"li\", 31);\n    i0.ɵɵlistener(\"click\", function ConfigChoicesComponent_div_14_div_1_li_16_Template_li_click_0_listener() {\n      var restoredCtx = i0.ɵɵrestoreView(_r12);\n      var c_r9 = restoredCtx.$implicit;\n      var content_r5 = i0.ɵɵnextContext().$implicit;\n      var ctx_r10 = i0.ɵɵnextContext(2);\n      return ctx_r10.setchoiceType(content_r5, c_r9.value);\n    });\n    i0.ɵɵelementStart(1, \"h6\", 21);\n    i0.ɵɵelement(2, \"i\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    var c_r9 = ctx.$implicit;\n    i0.ɵɵproperty(\"ngStyle\", i0.ɵɵpureFunction0(5, _c0));\n    i0.ɵɵadvance(2);\n    i0.ɵɵclassMap(c_r9.value.icon);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", c_r9.value.type, \"\");\n  }\n}\n\nfunction ConfigChoicesComponent_div_14_div_1_li_25_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\", 27);\n    i0.ɵɵelementStart(1, \"small\", 27);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    var choice_r13 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(choice_r13.text);\n  }\n}\n\nvar _c1 = function _c1() {\n  return {\n    \"cursor\": \"move\"\n  };\n};\n\nfunction ConfigChoicesComponent_div_14_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    var _r15 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 12);\n    i0.ɵɵpipe(1, \"json\");\n    i0.ɵɵelementStart(2, \"section\", 13);\n    i0.ɵɵelementStart(3, \"div\", 14);\n    i0.ɵɵelementStart(4, \"div\", 15);\n    i0.ɵɵelementStart(5, \"button\", 16);\n    i0.ɵɵlistener(\"click\", function ConfigChoicesComponent_div_14_div_1_Template_button_click_5_listener() {\n      var restoredCtx = i0.ɵɵrestoreView(_r15);\n      var content_r5 = restoredCtx.$implicit;\n      var contentIndex_r6 = restoredCtx.index;\n      var ctx_r14 = i0.ɵɵnextContext(2);\n      return ctx_r14.edit(content_r5, contentIndex_r6);\n    });\n    i0.ɵɵelementStart(6, \"small\");\n    i0.ɵɵelement(7, \"i\", 17);\n    i0.ɵɵtext(8, \" edit \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"div\", 18);\n    i0.ɵɵelementStart(10, \"div\", 19);\n    i0.ɵɵelementStart(11, \"a\", 20);\n    i0.ɵɵelementStart(12, \"span\", 21);\n    i0.ɵɵelement(13, \"i\");\n    i0.ɵɵtext(14);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"ul\", 22);\n    i0.ɵɵtemplate(16, ConfigChoicesComponent_div_14_div_1_li_16_Template, 4, 6, \"li\", 23);\n    i0.ɵɵpipe(17, \"keyvalue\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(18, \"div\", 24);\n    i0.ɵɵelementStart(19, \"fieldset\", 25);\n    i0.ɵɵelementStart(20, \"legend\", 26);\n    i0.ɵɵelementStart(21, \"small\", 27);\n    i0.ɵɵelement(22, \"i\", 28);\n    i0.ɵɵtext(23);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(24, \"ul\", 29);\n    i0.ɵɵtemplate(25, ConfigChoicesComponent_div_14_div_1_li_25_Template, 3, 1, \"li\", 30);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    var content_r5 = ctx.$implicit;\n    var ctx_r4 = i0.ɵɵnextContext(2);\n    i0.ɵɵattribute(\"data-content\", i0.ɵɵpipeBind1(1, 10, content_r5));\n    i0.ɵɵadvance(13);\n    i0.ɵɵclassMap(ctx_r4.getChoiceType(content_r5.html.tag).icon);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r4.getChoiceType(content_r5.html.tag).type, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(17, 12, ctx_r4.choiceTypes));\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngStyle\", i0.ɵɵpureFunction0(14, _c1));\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", content_r5.description, \" \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngStyle\", i0.ɵɵpureFunction0(15, _c1));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", content_r5.html.choices);\n  }\n}\n\nvar _c2 = function _c2(a0, a1, a2) {\n  return {\n    itemsPerPage: a0,\n    currentPage: a1,\n    totalItems: a2\n  };\n};\n\nfunction ConfigChoicesComponent_div_14_Template(rf, ctx) {\n  if (rf & 1) {\n    var _r17 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 9);\n    i0.ɵɵlistener(\"dragulaModelChange\", function ConfigChoicesComponent_div_14_Template_div_dragulaModelChange_0_listener($event) {\n      var restoredCtx = i0.ɵɵrestoreView(_r17);\n      var choices_r3 = restoredCtx.ngIf;\n      return choices_r3.data = $event;\n    });\n    i0.ɵɵtemplate(1, ConfigChoicesComponent_div_14_div_1_Template, 26, 16, \"div\", 10);\n    i0.ɵɵpipe(2, \"paginate\");\n    i0.ɵɵelementStart(3, \"pagination-controls\", 11);\n    i0.ɵɵlistener(\"pageChange\", function ConfigChoicesComponent_div_14_Template_pagination_controls_pageChange_3_listener($event) {\n      i0.ɵɵrestoreView(_r17);\n      var ctx_r18 = i0.ɵɵnextContext();\n      return ctx_r18.pageChange($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    var choices_r3 = ctx.ngIf;\n    i0.ɵɵproperty(\"dragulaModel\", choices_r3.data);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind2(2, 2, choices_r3.data, i0.ɵɵpureFunction3(5, _c2, choices_r3.per_page, choices_r3.current_page, choices_r3.total)));\n  }\n}\n\nvar _c3 = function _c3() {\n  return {\n    cursor: \"pointer\"\n  };\n};\n\nexport var ConfigChoicesComponent = /*#__PURE__*/(function () {\n  var ConfigChoicesComponent = /*#__PURE__*/function () {\n    function ConfigChoicesComponent(htmlElementService, dragulaService, router, modalService, cd, location, contentChoiceItemService, activatedRoute) {\n      _classCallCheck(this, ConfigChoicesComponent);\n\n      this.htmlElementService = htmlElementService;\n      this.dragulaService = dragulaService;\n      this.router = router;\n      this.modalService = modalService;\n      this.cd = cd;\n      this.location = location;\n      this.contentChoiceItemService = contentChoiceItemService;\n      this.activatedRoute = activatedRoute;\n      this.queryField = new FormControl();\n      this.options = {\n        size: 'lg',\n        backdrop: 'static',\n        keyboard: false,\n        centered: true\n      };\n      this.loadingSubject = new BehaviorSubject(false);\n      this.loading$ = this.loadingSubject.asObservable();\n    }\n\n    _createClass(ConfigChoicesComponent, [{\n      key: \"ngOnInit\",\n      value: function ngOnInit() {\n        var _this = this;\n\n        this.choiceTypes = CHOICE_TYPE; //this.activatedRoute.queryParams.subscribe(x => this.loadPage(x.page || 1));\n\n        this.choices$ = this.queryField.valueChanges.pipe(startWith(''), delay(0), map(function (value) {\n          return value.trim();\n        }), distinctUntilChanged(), tap(function (value) {\n          if (value.length > 1 || value == '') {\n            _this.loadingSubject.next(true);\n          }\n        }), filter(function (value) {\n          if (value == '' || value.length > 1) {\n            return true;\n          }\n\n          return false;\n        }), debounceTime(1000), switchMap(function (value) {\n          console.log('value', value);\n\n          if (value == '') {\n            return _this.htmlElementService.getOptionChoices();\n          }\n\n          return _this.htmlElementService.getOptionChoices().pipe(tap(function (d) {\n            console.log('jogos', d);\n          }), map(function (result) {\n            var paginateData = result.paginate.data;\n            var newData = [];\n            paginateData.forEach(function (data) {\n              if (data.description.toLowerCase().includes(value.toLowerCase())) {\n                newData.push(data);\n              }\n            });\n            console.log('paginateData', paginateData, 'newData', newData);\n            result.paginate.data = newData;\n            return result;\n          }));\n        }), tap(function () {\n          _this.loadingSubject.next(false);\n        }));\n      }\n    }, {\n      key: \"edit\",\n      value: function edit() {\n        var _this2 = this;\n\n        var content = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n        var index = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n\n        if (content == null) {\n          content = {\n            description: \"\",\n            html: {\n              category: \"form\",\n              content_choice_id: null,\n              content_html_tag_id: 2,\n              choices: [],\n              group: \"\",\n              label: \"Type your Text\",\n              tag: \"radio\"\n            }\n          };\n        }\n\n        var modal = this.modalService.open(ConfigChoiceFormComponent, this.options);\n        modal.componentInstance.content = content;\n        modal.componentInstance.index = index;\n        modal.componentInstance.emitData.subscribe(function ($e) {\n          if ($e.choices.length > 0) {\n            var groups = $e.choices.map(function (choice) {\n              return choice.text;\n            });\n            _this2.choices$ = _this2.choices$.pipe(map(function (result) {\n              if (index == null) {\n                content.html.choices = $e.choices;\n                content.description = groups.join('|');\n                result.paginate.data.push(content);\n                return result;\n              }\n\n              result.paginate.data[index].html.choices = $e.choices;\n              return result;\n            }), tap(function (x) {\n              return console.log(x);\n            }));\n          }\n\n          modal.dismiss();\n        });\n      }\n    }, {\n      key: \"loadPage\",\n      value: function loadPage(page) {\n        this.choices$ = this.htmlElementService.getOptionChoices();\n        /*this.choices$ = this.htmlElementService\r\n        //.queryParams({ page: page })\r\n        .getStaticOptionChoices()\r\n        .pipe(\r\n            map(result => {\r\n                return result.paginate;\r\n            })\r\n        );*/\n\n        /*this.htmlElementService.queryParams({\r\n            page: page\r\n        }).subscribe(result => {\r\n            this.choices = result.paginate;\r\n        });*/\n      }\n    }, {\n      key: \"pageChange\",\n      value: function pageChange($e) {\n        var navigationExtras = {\n          queryParams: {\n            'page': $e\n          }\n        }; // Navigate to the login page with extras\n\n        this.router.navigate([], navigationExtras);\n      }\n    }, {\n      key: \"getChoiceType\",\n      value: function getChoiceType(tag) {\n        return this.choiceTypes[tag.toUpperCase()];\n      }\n    }, {\n      key: \"ngOnDestroy\",\n      value: function ngOnDestroy() {\n        this.dragulaService.destroy('pages');\n        this.dragulaService.destroy('contents');\n        this.dragulaService.destroy('columns');\n        this.dragulaService.destroy('rowSortable');\n        this.dragulaService.destroy('sortableElements');\n      }\n    }, {\n      key: \"setchoiceType\",\n      value: function setchoiceType(content, choiceType) {\n        content.html.tag = choiceType.type;\n      }\n    }]);\n\n    return ConfigChoicesComponent;\n  }();\n\n  ConfigChoicesComponent.ɵfac = function ConfigChoicesComponent_Factory(t) {\n    return new (t || ConfigChoicesComponent)(i0.ɵɵdirectiveInject(i1.HtmlElementService), i0.ɵɵdirectiveInject(i2.DragulaService), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(i4.NgbModal), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i5.Location), i0.ɵɵdirectiveInject(i6.ContentChoiceItemService), i0.ɵɵdirectiveInject(i3.ActivatedRoute));\n  };\n\n  ConfigChoicesComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ConfigChoicesComponent,\n    selectors: [[\"app-config-choices\"]],\n    decls: 16,\n    vars: 9,\n    consts: [[1, \"border-bottom\", \"border-dark\", \"p-1\", \"text-uppercase\", 3, \"ngStyle\"], [1, \"text-right\"], [1, \"btn\", \"btn-link\", \"text-dark\", 3, \"click\"], [1, \"fas\", \"fa-plus-square\"], [1, \"form-group\"], [\"for\", \"query__field\"], [\"type\", \"text\", \"id\", \"query__field\", 1, \"form-control\", 3, \"formControl\"], [4, \"ngIf\"], [\"dragula\", \"contents\", \"class\", \"menu-content-sortable no-gutters collapse m-1 show\", \"aria-expanded\", \"true\", 3, \"dragulaModel\", \"dragulaModelChange\", 4, \"ngIf\"], [\"dragula\", \"contents\", \"aria-expanded\", \"true\", 1, \"menu-content-sortable\", \"no-gutters\", \"collapse\", \"m-1\", \"show\", 3, \"dragulaModel\", \"dragulaModelChange\"], [\"class\", \"content-handle menu-content-sortable option-type-sortable\", 4, \"ngFor\", \"ngForOf\"], [1, \"mt-1\", 3, \"pageChange\"], [1, \"content-handle\", \"menu-content-sortable\", \"option-type-sortable\"], [1, \"p-1\", \"mb-1\"], [1, \"row\"], [1, \"col-md-4\"], [1, \"btn\", \"btn-sm\", \"btn-block\", \"btn-link\", \"text-dark\", 3, \"click\"], [1, \"fas\", \"fa-pen-square\"], [1, \"col-md-8\"], [1, \"dropdown\"], [\"href\", \"javascript:void(0)\", \"id\", \"dropdownMenuLink\", \"data-toggle\", \"dropdown\", \"aria-haspopup\", \"true\", \"aria-expanded\", \"false\", 1, \"btn\", \"btn-sm\", \"btn-block\", \"dropdown-toggle\"], [1, \"text-uppercase\"], [\"aria-labelledby\", \"dropdownMenuLink\", 1, \"dropdown-menu\", \"w-100\"], [\"class\", \"dropdown-item\", 3, \"ngStyle\", \"click\", 4, \"ngFor\", \"ngForOf\"], [1, \"border\", \"border-bottom\"], [1, \"content-handle\", \"border\", \"border-dark\", 3, \"ngStyle\"], [1, \"content-handle\", \"text-center\", \"w-auto\"], [1, \"content-handle\"], [1, \"fa\", \"fa-arrows-alt\", \"content-handle\"], [1, \"text-dark\", \"text-capitalize\", \"content-handle\", 3, \"ngStyle\"], [\"class\", \"content-handle\", 4, \"ngFor\", \"ngForOf\"], [1, \"dropdown-item\", 3, \"ngStyle\", \"click\"]],\n    template: function ConfigChoicesComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\");\n        i0.ɵɵelementStart(1, \"div\", 0);\n        i0.ɵɵelementStart(2, \"span\", 1);\n        i0.ɵɵtext(3, \" Option Group \");\n        i0.ɵɵelementStart(4, \"button\", 2);\n        i0.ɵɵlistener(\"click\", function ConfigChoicesComponent_Template_button_click_4_listener() {\n          return ctx.edit();\n        });\n        i0.ɵɵelementStart(5, \"small\");\n        i0.ɵɵelement(6, \"i\", 3);\n        i0.ɵɵtext(7, \" create \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(8, \"div\", 4);\n        i0.ɵɵelementStart(9, \"label\", 5);\n        i0.ɵɵtext(10, \"Procurar\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(11, \"input\", 6);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(12, ConfigChoicesComponent_div_12_Template, 3, 0, \"div\", 7);\n        i0.ɵɵpipe(13, \"async\");\n        i0.ɵɵtemplate(14, ConfigChoicesComponent_div_14_Template, 4, 9, \"div\", 8);\n        i0.ɵɵpipe(15, \"async\");\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        var tmp_3_0;\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngStyle\", i0.ɵɵpureFunction0(8, _c3));\n        i0.ɵɵadvance(10);\n        i0.ɵɵproperty(\"formControl\", ctx.queryField);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(13, 4, ctx.loading$));\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", (tmp_3_0 = i0.ɵɵpipeBind1(15, 6, ctx.choices$)) == null ? null : tmp_3_0.paginate);\n      }\n    },\n    directives: [i5.NgStyle, i7.DefaultValueAccessor, i7.NgControlStatus, i7.FormControlDirective, i5.NgIf, i2.DragulaDirective, i5.NgForOf, i8.PaginationControlsComponent],\n    pipes: [i5.AsyncPipe, i8.PaginatePipe, i5.JsonPipe, i5.KeyValuePipe],\n    styles: [\"\"]\n  });\n  return ConfigChoicesComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}